"""
データセット内のにあるマルウェアだけの
CSVファイルを作成する。
"""
import pandas as pd
import numpy as np



def main():
    ## 対象のCSVを取得する ##
    taerget_csv = "../CSV/dataset6CSV/origin/6label.csv"

    df = pd.read_csv(taerget_csv, index_col=0)
    print(df.head())
    
    ## クリーンウェアの行を削除する ##
    clean_drop_df = df[df["LABEL"] != 0.0]
    print(clean_drop_df["LABEL"].unique())

    ## LABEL付け ##
    for index_name in clean_drop_df.index[:]:
        if index_name.startswith("Backdoor"):
            clean_drop_df.loc[index_name, 'LABEL'] = 0
        elif index_name.startswith("Packed"):
            clean_drop_df.loc[index_name, 'LABEL'] = 1
        elif index_name.startswith("Ransom"):
            clean_drop_df.loc[index_name, 'LABEL'] = 2
        elif index_name.startswith("Infostealer.Limitail"):
            clean_drop_df.loc[index_name, 'LABEL'] = 3
        elif index_name.startswith("Trojan.Gen"):
            clean_drop_df.loc[index_name, 'LABEL'] = 4
        else:
            print("ラベル付けできないファイルがあります。")
            print("index_name = ", index_name)
            exit()

    ##保存する##
    clean_drop_df.to_csv("../CSV/dataset6CSV/origin/malware_6label.csv")


if __name__ == "__main__":
    main()